data.raw <- c("m,n,size",
              "1,1,1",
              "1,2,2",
              "1,3,6",
              "1,4,24",
              "1,5,120",
              "1,6,720",
              "1,7,5040",
              "1,8,40320",
              "1,9,362880",
              "1,10,3628800",
              "1,11,39916800",
              "1,12,479001600",
              "1,13,6227020800",
              "1,14,87178291200",
              "1,15,1307674368000",
              "1,16,20922789888000",
              "2,1,1",
              "2,2,6",
              "2,3,90",
              "2,4,2520",
              "2,5,113400",
              "2,6,7484400",
              "2,7,681080400",
              "2,8,81729648000",
              "2,9,12504636144000",
              "2,10,2375880867360000",
              "2,11,548828480360160000",
              "2,12,151476660579404160000",
              "2,13,49229914688306352000000",
              "2,14,18608907752179801056000000",
              "2,15,8094874872198213459360000000",
              "2,16,4015057936610313875842560000000",
              "3,1,1",
              "3,2,20",
              "3,3,1680",
              "3,4,369600",
              "3,5,168168000",
              "3,6,137225088000",
              "3,7,182509367040000",
              "3,8,369398958888960000",
              "3,9,1080491954750208000000",
              "3,10,4386797336285844480000000",
              "3,11,23934366266775567482880000000",
              "3,12,170891375144777551827763200000000",
              "3,13,1561776277448122046153927884800000000",
              "3,14,17929191665104441089847092117504000000000",
              "3,15,254415229727832019064930237147381760000000000",
              "3,16,4400365813372582601747033381701114920960000000000",
              "4,1,1",
              "4,2,70",
              "4,3,34650",
              "4,4,63063000",
              "4,5,305540235000",
              "4,6,3246670537110000",
              "4,7,66475579247327250000",
              "4,8,2390461829733887910000000",
              "4,9,140810154080474667338550000000",
              "4,10,12868639981414579848070084500000000",
              "4,11,1746930746117010628955362040959500000000",
              "4,12,339917784579447928182134345929899510000000000",
              "4,13,92024242230271040357108320801872044844750000000000",
              "4,14,33799583928756250412762315147319583351028227500000000000",
              "4,15,16481860109099054170027351546863185027378649716962500000000000",
              "4,16,10472178348678920642335298516439743049955736942564765400000000000000",
              "5,1,1",
              "5,2,252",
              "5,3,756756",
              "5,4,11732745024",
              "5,5,623360743125120",
              "5,6,88832646059788350720",
              "5,7,28837919555681211870935040",
              "5,8,18975581770994682860770223800320",
              "5,9,23183587808948692737291767860055162880",
              "5,10,49120458506088132224064306071170476903628800",
              "5,11,170878335353097656943918169452451079403744627916800",
              "5,12,933254079070967090571092409482594999576504130303138201600",
              "5,13,7708574168669332219803079339976372645861971547841327593737420800",
              "5,14,93296981083443289226927746494844797802084483711125257645590316266291200",
              "5,15,1610248982341770271650344478575659354737318917318958160555725048663263674368000",
              "5,16,38710411299479874798798627670470508098434822569450431283090199061465637344025509888000",
              "6,1,1",
              "6,2,924",
              "6,3,17153136",
              "6,4,2308743493056",
              "6,5,1370874167589326400",
              "6,6,2670177736637149247308800",
              "6,7,14007180988362844601443040716800",
              "6,8,171889289584866507880743491472699801600",
              "6,9,4439413043841128802009762476941510771390464000",
              "6,10,222254153109036134585784467278853023447384195031040000",
              "6,11,20193738534370392855946567010492898163504440783192016158720000",
              "6,12,3155047657047550647344092936068234950821139281116585358956767477760000",
              "6,13,810379023013676374613612784457359175953156184071948330401693262706783027200000",
              "6,14,329404116499810705869263728044366560004006597374713764429902417639450784169249996800000",
              "6,15,205091822115006537704830464408763909341267366142016381796430854694692123388747444135133184000000",
              "6,16,190130025855986503728175134637676944891231668992503309884597697097984770789697050769809965041319936000000",
              "7,1,1",
              "7,2,3432",
              "7,3,399072960",
              "7,4,472518347558400",
              "7,5,3177459078523411968000",
              "7,6,85722533226982363751829504000",
              "7,7,7363615666157189603982585462030336000",
              "7,8,1707750599894443404262670865631874246246400000",
              "7,9,944848320304251231447932170080297903208364959334400000",
              "7,10,1132660280615199084788650081767001496435194805783906746368000000",
              "7,11,2723830889210171089860112853974967135419836738473819181448031109120000000",
              "7,12,12337226409200196605517015788291901703895365914750779072463046228231449477120000000",
              "7,13,99857389527875317071126025668509769247773376500453182107373195308821853117289909452800000000",
              "7,14,1381468383008825357104956008957921143921881146573317236506494809352629746390847721930705443225600000000",
              "7,15,31443220165949648614619735620545968083193871161394475412571881611159381526003157207639217139343918366720000000000",
              "7,16,1139121537516734340515316264575525709380994071704433336488330155338908231305677860284677208521545322102598024560640000000000",
              "8,1,1",
              "8,2,12870",
              "8,3,9465511770",
              "8,4,99561092450391000",
              "8,5,7656714453153197981835000",
              "8,6,2889253496242619386328267523990000",
              "8,7,4104167472585675600759440022842715359250000",
              "8,8,18165723931630806756964027928179555634194028454000000",
              "8,9,217425846656446788579638892849417587480505167467321080630000000",
              "8,10,6302639807323954570950478140057361672954518442725941235740270404500000000",
              "8,11,405114246492469383880569411508727111186984982456058912421243354102184620671500000000",
              "8,12,53718560818714720458897117143972907723106392453990481177971918960420188915358273272310000000000",
              "8,13,13836586408700057277835742645624997019124314304216662079505821747028089846518348698140615688953550000000000",
              "8,14,6579173179349045090938001891627589852626501627084356605369513834797728879569673776087997016470782376455043500000000000",
              "8,15,5528228628446878498239989026525923540434014677155378331297838772941230397633114300344438108341598090222882345015853282500000000000",
              "8,16,7903723133164116281434241042971006843118109431109574087182006028061638448815570197274813397083621354846429395842297358039496503000000000000000",
              "9,1,1",
              "9,2,48620",
              "9,3,227873431500",
              "9,4,21452752266265320000",
              "9,5,19010638202652030712978200000",
              "9,6,101097362223624462291180422369532000000",
              "9,7,2392741010223442438553822446842770682716580000000",
              "9,8,203653377853981828616656775313699668953042169048889600000000",
              "9,9,53130688706387569792052442448845648519471103327391407016237760000000000",
              "9,10,37523683246739604798437640757064788691448682515186187946951441469287068800000000000",
              "9,11,64954656894649578274066349293466217242333450230560675312538868633528911487364888307200000000000",
              "9,12,254063377487959802604754828193830736698433831578433630945547526206870064656268628007435542119680000000000000",
              "9,13,2098283691017905556743059330263090826651564364479511666245634994095924107390340828369314679620130235122060800000000000000",
              "9,14,34551264216996369105668450904854136634250909008156769134654438964548904980838542648344830412091176568184806610617219200000000000000000",
              "9,15,1079898897239247935056578516394475936641683113929939856733032350804418508229058093464737656772856837334829449527223170441938715392000000000000000000",
              "9,16,61391387547182500480747376959791472086295424394459916722189422709940356111793665920675193768265502116962921631008834779204163308344032035966976000000000000000000",
              "10,1,1",
              "10,2,184756",
              "10,3,5550996791340",
              "10,4,4705360871073570227520",
              "10,5,48334775757901219912115629238400",
              "10,6,3644153415887633116359073848179365185734400",
              "10,7,1445652147019814670743591757156403283835679622544230400",
              "10,8,2380254854046163126683949421708285053672305429067135034327451648000",
              "10,9,13616594176576867789257051077923670520352897911110763882189739080374891526144000",
              "10,10,235707458939304389640931968316130209128979624196658578574141046497349714005349706689167360000",
              "10,11,11054122758897419294988690503391777998202007489501521320102682328562886186589764491787451321974298460160000",
              "10,12,1283031895074665065908839744910282257426380667828281243966296893559002565208928184735928841211269190744431261667164160000",
              "10,13,341801314619214783897087450315588799467537408512044322202522822064765740616027733168614577914097394948247544027425960818621284352000000",
              "10,14,196077394995108164765691629211176119081949389527251731982837082833769406775400791412741187745448633177186327919290265431757825444306170589741056000000",
              "10,15,229323160100762408757969303995614285797190285773181620054274504999121541119855593089612298028280872318294351006463619605010609351656123615676551535664022159360000000",
              "10,16,521492077063958719007153097088685449551778873230571895362441434186643038315530802508906975755572795287678285099159990288933320048252879769732058766004782458410121078306242560000000",
              "11,1,1",
              "11,2,705432",
              "11,3,136526995463040",
              "11,4,1047071828879079131681280",
              "11,5,125285878026462826569986857692288000",
              "11,6,134567406165969006655507763343147223231094784000",
              "11,7,899137301820591022981789354349662423494513642393068912640000",
              "11,8,28777796000483319743387730772625373042207453714244694689458618264453120000",
              "11,9,3627456326803425127928395281036678870444209783298516141382217921006385218333552148480000",
              "11,10,1546537533488980922345157551855126219741196608940192310282356303162290256478842819703829058551808000000",
              "11,11,1974541741794281640478511220005869186921182708889561612461104493325636081139918127543287633935664622584450777088000000",
              "11,12,6833918050092661330200844586777231833865654893742891687386213367553375191254762550972928270482775850164402447046204504355635200000000",
              "11,13,59010480200543571368485245640273163806436901720785229229221182847018870887265523581533912958353211244393073809080113479919164340907010739404800000000",
              "11,14,1185075569921042649063318361317491561353136345998523504963205795629669752119773862158607479184436193187453614231483521286292372295774379825822429549955121152000000000",
              "11,15,52116681851652057347953634925447799896575032070826558271890144366760636478585512919073167496897250784540206818353556148748584827779869494527424956734407979644341090915450880000000000",
              "11,16,4763883490568965651538676139335619622359909511316524166172755582368208145792448848114911418494586355469757273049764107899760974839637257622562112924743676606520414549853884972081304148377600000000000",
              "12,1,1",
              "12,2,2704156",
              "12,3,3384731762521200",
              "12,4,235809301462142612780721600",
              "12,5,329981831728425465309559251123033960000",
              "12,6,5069604695159014361907133760188983275669965445760000",
              "12,7,572829299678863094399149289677924945885273576335477018784723200000",
              "12,8,357828507906605357621913682939425333937200233590353882122965083050277486336000000",
              "12,9,997851202508289965251241217591143947291320854940829073797598354017864287211494279063233280000000",
              "12,10,10520205089511509502204586601359950893946426007022179811372468120513168255407009193012644040799259867929600000000",
              "12,11,367140062997333906808069127562476648685753888568923636178739870802507293049946514298772948344647959476855723009119262720000000000",
              "12,12,38042794062542322693066706940668751181316120854134371204350317007898008314172525001625187022043631729257982320896300331429904298296975360000000000",
              "12,13,10690594609119092142437335306374030116955598835735144549767427496548679271579011213492372907477275355576959578070378241471393530176623722017429728963584000000000000",
              "12,14,7546209737021743691447199318014295648131959358813396484428388859554959777128787657237007928153597796678300615697566575761022402268041343231667461458916459592605235634176000000000000",
              "12,15,12529015991544192722274058186837417160148676160296936356026288798299876445442793348169662706769951758935443086437006839378300948857552372191327796167019417550826532669285420549117631283200000000000000",
              "12,16,46220326027215606920069129914233478545205114232280990108958001113846137085288761160475792002495165277180693450635411432098650311797857510272027264643899624921031817289235423001764922043243442216622037401600000000000000",
              "13,1,1",
              "13,2,10400600",
              "13,3,84478098072866400",
              "13,4,53644737765488792839237440000",
              "13,5,880904182555008823696060440775388083200000",
              "13,6,194235561717726714396261230699553111831148037803776000000",
              "13,7,372404540652526524309022025282173721629476810891337214880003240960000000",
              "13,8,4555680234720105440238282548052899942827748046631318952792365530238377420155289600000000",
              "13,9,282007582088543349224691594089721366488498826381508437246413020308416177988616158293066795409408000000000",
              "13,10,73771734103661567463893565734245138346932165513360057179247127583929367764182482591131387629201871331693625344000000000000",
              "13,11,70610616432933061123210253638649351016123347284281078987304355400536584844561425748234256178658342287634213686114406742146875392000000000000",
              "13,12,219795399312804439658594727320520541818146963102195447730999211531346778990732331009904958972125716731525473017935363767461684751419545228961382400000000000000",
              "13,13,2016921336949469698818700939326452107485401117523876702816583899546207367473562760410079989002973932908078005814093791250767635280057991153639867255137345325550796800000000000000",
              "13,14,50210778868757246780839847235967329364233046048821481149334928084784420992425369829291650267792174533198210110289615222760514647142367092985689206810364997491127418687565034537615360000000000000000",
              "13,15,3158008788951212594271584861045037232738907978932962141832466195542371781113037410686259603251063657360270352746749042792833331517784644875667675898582173929729019262927900325973513696985994174346035200000000000000000",
              "13,16,471771793851497516544043629897519921716862036509188325515420637708250071924563603894922081860917077159982055861844569692119144594949597935321993647882433661519977032733779868779136366110149965218898558055525234606342144000000000000000000",
              "14,1,1",
              "14,2,40116600",
              "14,3,2120572665910728000",
              "14,4,12309355935372581458927646400000",
              "14,5,2378829279642818668557063558238537401024000000",
              "14,6,7549772408186210925513111415511935301874298711542842880000000",
              "14,7,246325853150103722138342857617746569302207136117111023444880016228659200000000",
              "14,8,59182298727043816552033187731994144441929453946960276479209774781233353367641897840640000000000",
              "14,9,81558876449082911540531518990642198177029972264603480297090552553962112398585409649024782032217981440000000000000",
              "14,10,530916799898985829715720473920476443405233662075451094837248073299380999347233445687300815861442429525303257142372761600000000000000",
              "14,11,13977652044436914637188658353135567106599567102481421524726131808468041189560494889776802382222225790065049921602244086719991812501815296000000000000000",
              "14,12,1310829311291020156900559608322524916260639806490543844576212832970232493991284904822900419435361070786156325848753200689134695058861125548453757160945090560000000000000000",
              "14,13,393924335209316230791116075206292858372061397419977222495030733309381986707219628309692467153725206678418729587465645425059373482965134422164433709686145219643936954814103552000000000000000000",
              "14,14,346862398297826764506388734764023516017745458925214356525724842700231830823347062852932454602709062199274172031708514929063008167030524203507219967969122724688683667288446749476009677174299688960000000000000000000",
              "14,15,828814487649017346573178634427486486069066845163566934304688114529667804806185439175523597718984263270625612341790111541935033981521260570071555857284007155990849555538064629040347824271423726102325729390857551872000000000000000000000",
              "14,16,5028448870575264434521448246070955381657977328223913606832023705120851561921516715366787744914802612340315857582718712268968478165240679418073304478145214661226857077549009210334426666103004974805755665294372776355702948123105571110912000000000000000000000",
              "15,1,1",
              "15,2,155117520",
              "15,3,53494979785374631680",
              "15,4,2845616726065971560165538537369600",
              "15,5,6488042236961891255293961040027911906585223168000",
              "15,6,297124266951557795491732759647936149084312007035052174151385088000",
              "15,7,165381827048882033236392621644870749397114496431129216223223376500829535904727040000",
              "15,8,782342562540943322988268297586952476812983096142501746972687148381511554020947968864897903582248960000",
              "15,9,24062020403830385108038136534074826027601760710269833066523858164235896424827388094647329296308060960804030757470208000000",
              "15,10,3907484821505281680445186052684379935408614641349388063322920765113062520101185702150130428602671180085825741251038708025846166695444480000000",
              "15,11,2836722187684164132430190095473555109523110806450709260558817938709280296825789489657242458577117137901847898623059421016940931192398954274418716559938682880000000",
              "15,12,8034818878548071894794693501533309081550797200256880253287532723051488708819375599924651395549343887534395620096853329575943088090618586719836952054891201539273705345120416563200000000",
              "15,13,79272606036470820958579947529310567434005113724019320808549822786573808550451671510844291597319169086217427728032118043418344334401104175357415784139683415200932855678742567360666901730130683284684800000000",
              "15,14,2475073265769973879792561597290033649261522881062141404651830236926523015102901824479552596996995974761050437946631180351521155855021659188509119847394928683154002650929231018368950506977151638260613294428852176241557504000000000",
              "15,15,225245447925661854334444042964896762436907230062993245349317817972662459662159232394491333020377204308549152861145329023307875372418180414601614587096750528495866876993414695206959743046975895034565912560947584721707561193352554587189160181760000000000",
              "15,16,55638437822707596412570352293713694394872615480778314270663059842551370432629251333053982409037193788956966048708730621196713466076534538966457372582941413314812774705565099726019295101547692725213639045432136025399641425419563788334359396870052201957124513684520960000000000",
              "16,1,1",
              "16,2,601080390",
              "16,3,1355345464406015082330",
              "16,4,662122768410971464603908403461821400",
              "16,5,17849652006367453441718319866826741334636604727435000",
              "16,6,11820969246826954556547676599863670334721199951925900837836206749590000",
              "16,7,112491961583223747444687648230816777914659202421427587155442407739828045531430875154450000",
              "16,8,10500339555034424633664938209355265493859812643023108576113659537281943032445713484832322664622168299430000000",
              "16,9,7223366176980805697040184331359035742417166760543628783606543319246643325381495222953483588450175715063379593746887961295670000000",
              "16,10,29326504599831624744091586563707925445100069056117965925607621371295210176172667304275055731591307761095910662794922221529792046991115845090116500000000",
              "16,11,588351802706151592380616717466277228694068088612433932064124131576896083145692782850138310173832104904191566063901324782067231820115132968396568268278683308311831167500000000",
              "16,12,50441652342310768161604089182274414687207395537711647324920282818469753314041464768499702500337895393051698891782455264394597825851094092246278682052886573763893036138518048631698927147510000000000",
              "16,13,16374283861263654193818744392978725238699091215101485264440367182618036141658980785353865083701273423006254285919643714205325750126484604641513336848747969476940798807318445019396665597440913265465874300492537550000000000",
              "16,14,18167424278605057236154238201700303643239653559527779305423147490229512505247943331091315486727414269948655635565397539859842041422733331525903762774695082840539395728927928291018435016033971552514496934020277452894077240419438986320300000000000",
              "16,15,63106602423143285686766258249530593067329496238573349633708528643375719848990174436959465321794774773634372243404303096065265520621322250093982520860578407301851884028525408477822886547348407460576328375820638411697768202859293317415391441789230656083951842500000000000",
              "16,16,636035770270440625306036310147097014876249135012826557241029982947235086364850835773119830709107444670777248110393161054135060217384530614525185696742967904128343224075791124803969540598786970878323700621037289219359234314080575871535106530254651800233829767445462171267971151671000000000000000");

data.frame <- read.csv(text=data.raw, check.names = FALSE);

m <- unname(unlist(data.frame$m));
n <- unname(unlist(data.frame$n));
size <- unname(unlist(data.frame$size));

m.count <- length(unique(m));
n.count <- length(unique(n));

stopifnot(m.count == n.count);

m.mat <- matrix(m, nrow=m.count, ncol=n.count);
n.mat <- matrix(n, nrow=m.count, ncol=n.count);
size.mat <- matrix(size, nrow=m.count, ncol=n.count);

library("plot3D");

dir <- dirname(sys.frame(1)$ofile);
source(file.path(dir, "..", "R", "utils.R"));
source(file.path(dir, "..", "R", "graphics.R"));

config <- list(logger=function(...) { }, graphics.ext="svg");

.graphic(config, file.path(dir, .graphics.name(config, "jssp_searchspace_size_scale")), 6, 6, {
  persp3D(x=m.mat,
          y=n.mat,
          z=log10(size.mat),
          box=TRUE,
          axes=TRUE,
          ticktype="detailed",
          facets=TRUE,
          colkey=FALSE,
          bty="b2",
          xlab="m",
          ylab="n",
          zlab="ld(|X|)",
          log="z");
});

